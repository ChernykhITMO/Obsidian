*Вертикальная масштабируемость* - x2 (стоимость х10)
*Горизонтальная масштабируемость* 

Проблема передачи данных

 **Распределенные бд** - набор узлов, которые хранят в разных географических, логических точках некоторые наборы данных(данные логически связаны)

*Виды:*
1. **Горизонтальное распределение**
- раскидать строки таблиц по разным серверам 
2. **Вертикальное распределение** 
- раскидываем столбцы по разным серверам 
3. **Гибридное распределение**
- комбинация горизонтального с вертикальным
- данные разносятся по узлам(отдельным сервам)

Как узлы между собой синхронизировать? 
Существуют:
1. **Раздельное** (каждый фрагмент данных хранится только на одном узле) (в виде одной копии) 
(единственный плюс - цена)
минус: потеря хоть одного узла - теряем часть данных 
- невысокая надёжность
- низкая доступность

2. **Размещение с полной репликацией**
- данные хранятся с полной копией на разных узлах
*плюс:*
выход одного из узлов
*минус:*
дорого

3. **Частичная(выборочная ) репликация**
- данные на каких-то узлах дублируются, на каких-то нет 
*плюс:* цена меньше
*минус:* надо контролировать 

#### Подходы в управлении репликацией
##### 1. Мастер слейв 
есть центральный сервер - мастер, который управляет репликацией 

*Общее правило:* мастер может только писать и читать данные, а слейв только отдавать 

Дёшево и сердито, но медленное обновление данных

##### 2. Мастер мастер 
Сервера, которы имеют право и читать и писать, включая соседей 
- сложный подход 

##### 3. P2P 
Каждый узел самостоятелен (не даёт другим писать, но может поделиться)
- могу запросить об

**Распределённые СУБД** - комплекс программ, которые обеспечивают управлением распределённых БД

для управлений субд 

**Прозрачность** - с любой целью получить данные приводит к тому же результату, что и при обычной БД 

##### Уровни прозрачностей: 
###### 1. Прозрачность фрагментаций 
Пользователь не видит, что система фрагментирована
###### 2. Прозрачность размещения фрагментов
Пользователь не знает ,на каком конкретном узле расположен тот фрагмент, к которому он обращается
###### 3. Прозрачность количества реплик 
Пользователь не может обратиться к конкретной реплике, не знает сколько раз данные продублированы
###### 4. Прозрачность контроля доступа
Пользователю не нужны доп права доступа к другим узлам, работает со своим узлом, не нужны доп права с других узлов

##### 

# Распределённость СУБД

##### 1. Гомогенные 
(однородные по ПО) (Oracle, Microsoft)
все узлы работают под одной операционной системой и управляются одним и тем же СУБД 
тип СУБД - один 

Data lake - данные хранятся на различных 


##### 2. Гетерогенные системы 
различные типы серверов (реляционные, хеш) (Data lake)


# **Теорема CAP** 
(Консистеность, доступность, партишен толеранность)

**Консистеность** - все пользователи видят набор данных в один и тот же момент времени

Доступность - гарантированный доступ к данным

Толерантность к разделение - при потере связи между узлами, мы получим нужные данные с той же эффективностью, что и раньше 

CA
CP
AP
3 состояния одновременно невозможно

Синхронность и ассинхронность апликаций 

Синхроность - запись на все нужные узлы
- повышает консистетность
- снижает производительность

Асинхроность - данные записываются только на один узел, а потом с течением времени расползаются по всей система
- запись по производительности увеличивается
- консистентность ниже плинтуса

Sharding - процесс распредления данных на логические блоки 


Распределённые системы 
1. гомомгенные - касандра с высокой горизонтальной масштабируемостью 
монго ди би - документированная бд
хадуб hdfs - гугловская, ориентированная на хранение масштабируемость горизонтальных бд
амазон dynamic db - 

### Дейт - 12 правил распределённых БД 

*Правила определяют прозрачность*
##### 1. Локальная автономность 
Локальные данные принадлежат локальному хосту и локально управляются.
Можем изолировать узел и работать с ним
##### 2. Для высокой прозрачность должна отсутствовать опора на центральный узел 
Одноранговая система
##### 3. Непрерывное функционирование 
не может возникнуть ситуация, когда распределённое СУБД выключается для профилактических работ
##### 4. Независимость от физического расположения 
Неважно как расположена сеть
##### 5. Независимость от фрагментации 
Неважно как и на какие фрагменты разбиты данные, пользователь всегда получает доступ к ним
##### 6. Независимость от репликаций 
Пользователь в каждый момент получения данных, гарантировано получает валидные данные (соответствуют запросу, нигде в системе нет других данных)
##### 7. Обработка распределённых запросов
Проблема из какого узла брать данные, пример билет из чехии в германию, через ОАЭ
##### 8. Проблема распределённых транзакций ()
##### 9. Независимость от оборудования
##### 10. Независимость от ПО
##### 11. Независимость от СУБД
##### 12. Независимость от операционной системы

#### Двухфазные транзакции 

Конструкция: на первом этапе узел подтверждает, что готов обработать транзакцию, на втором обрабатывает 

Известить все узлы, получить ответ, выполнять 


# Преимущества распределённых СУБД
- Максимально близки к структуре организации (каждый отдел имеет свою БД)
- Разделяемость и потенциальная автономность (каждый узел может существовать и обрабатывать интересы локальных пользователей)
- Повышение доступности данных (можем получить данные от соседей)
- Повышение надёжности 
- Повышение производительности 
- Модульность системы (горизонтальная масштабируемость)

# Недостатки распределённых СУБД
-  Сложность - сложность, как отражение реального мира
- Сложность сделать так, чтобы данные распределялись 
- Всё сложное - дорогое 
- Проблема защиты (каждый узел автономен -> автономные права, доступ -> проблема управления безопасностью)
- Проблема целостности данных (данные должны отображать предметную область)
- Отсутствие стандартов (стандартность взаимодействия)

# No SQL системы (not only)
Закон МУРА (данные удваиваются)
- количество информации очень незначительное и валяется просто так (на 20 год 3%)
- информация перестала быть изолированной (огромное кол-во информации связано либо прямыми ссылками, либо косвенными)
- слабо структурированная информация (нужно обрабатывать и хранить)
- исчезновение идеи мейнфреймов(суперкомпьютер) - утопическая идея 
идея вертикальной масштабируемости 

Появились No SQL системы, отличные от реляционных моделей 
Понятие агрегато - механизм, который позволяет группировать некоторые данные и хранить их по каким-то признакам 
Агрегатный подход:
- оптимизация под определённый тип запросов (только один тип, но очень быстро -> высокая скорость)
- Хранение данных в том виде, 
- Внутренняя поддержка атомарности 
Позволило решить кучу проблем:
1. Реляционные БД всегда медленные 
2. Реляциооные БД не умеют хранить данные в нужном нам виде (нормализация)
3. ACID св-во - (Атомарность )
Жертвами АСИД ситуации, когда мы стали пренебрегать 
overbooking 

Конструкция BASE - 
каждый запрос так или иначе завершается

S - Soft State (мягкое состояние) - БД может меняться,даже если данные не поступали 
E - (согласованность в конечном итоге) - пр. в самолёте полетит человек не больше, сколько есть мест (overbooking)




